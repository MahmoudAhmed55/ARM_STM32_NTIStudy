/*
 * SYSTICK_Program.c
 *
 *  Created on: Nov 8, 2023
 *      Author: lenovo
 */

#include "../../lib/STD_TYPES.h"
#include "../../lib/BIT_MATH.h"
#include "SYSTICK_Interface.h"
#include "SYSTIC_Private.h"

static void (*PTR1)(void)=NULL_PTR;
static void (*PTR2)(void)=NULL_PTR;
void SYSTICK_Init(void)
{
	SIT_BIT(STK_CTRL,0);    //ENABLE SYSTICK
	CLR_BIT(STK_CTRL,2);    /* IF SIT CLOCK=AHB ,IF CLR CLOCK=AHB/8*/
}


void SYSTICK_BusyWait_Us(u32 ticks)
{
	STK_LOAD=ticks;
	while (STK_VAL>0);
	STK_LOAD=0;
}
void SYSTICK_BusyWait_Ms(u16 ticks)
{
	ticks=ticks*1000;
	SYSTICK_BusyWait_Us(ticks);

}
void SYSTICK_StopTimer(void)
{
	CLR_BIT(STK_CTRL,0);
}



u32 SYSTICK_GetLIpsedTime(void)
{
	return (STK_LOAD- STK_VAL);
}

u32 SYSTICK_GetRemainingTime(void)
{
	return STK_VAL;
}

void SYSTICK_InterruptEnable(void)
{
	SIT_BIT(STK_CTRL,1);  //SYSTICK_INTERRUPT
}
void SYSTICK_InterruptDisable(void)
{
	CLR_BIT(STK_CTRL,1);
}

void SYSTICK_IntervalSingle(u32 ticks,void(*ptr)(void))
{
	STK_LOAD=ticks;
	PTR1=ptr;
}
void SYSTICK_IntervalPeriodic(u32 ticks,void(*ptr)(void))
{
	PTR2=ptr;
}


void SysTick_Handler(void)
{
	PTR1();

}
