/*
 * main.c
 *
 *  Created on: Nov 2, 2023
 *      Author: Mahmoud Ahmed Ismail
 */

#include "lib/STD_TYPES.h"
#include "lib/BIT_MATH.h"

#include "MCAL/RCC/RCC_Interface.h"
#include "MCAL/GPIO/GPIO_Interface.h"
#include "MCAL/NVIC/NVIC_Interface.h"
#include "MCAL/SYSTICK/SYSTICK_Interface.h"
#include "MCAL/EXI_Interrupt/EXI_Interrupt_Interface.h"
#include "MCAL/AFIO/AFIO_Interface.h"
#include "MCAL/TIMER/TIMER_Interface.h"
#include "HAL/LCD/LCD_Interface.h"
#include "MCAL/TIMER/TIMER_Services.h"
#include "MCAL/UART/UART_Interface.h"

volatile u8 x='1';
void uart(void)
{
	GPIO_SetPinValue(PINB5,HIGH);

	LCD_GoTo(2,0);
	LCD_WriteChar(x);
}


void main(void)
{
	//__enable_irq();
	RCC_InitClockSystem();
	RCC_EnableClock(APB2,AFIO_EN);
	RCC_EnableClock(APB2,IOPA);
	RCC_EnableClock(APB2,IOPB);
	RCC_EnableClock(APB2,IOPC);
	RCC_EnableClock(APB2,USART);

	DIO_Init();
	SYSTICK_Init();
	UART_Init();
	//LCD_Init();

	Interrupt_Set_Enable(USART1);
	UART_TX_InterruptEnable();
	UART_TX_SetCallBack(uart);

	UART_RX_InterruptEnable();
	UART_RX_SetCallBack(uart);



	while (1)
	{
		x=UART_Recieve();

		if (x=='0')
		{
			GPIO_SetPinValue(PINA0,HIGH);
		}
		else if (x=='1')
		{
			GPIO_SetPinValue(PINA1,HIGH);
		}
		else if (x=='2')
		{
			GPIO_SetPinValue(PINA2,HIGH);
		}





	}
}





